<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AlfieVR - Stereo 3D Vision</title>
    <meta name="description" content="Stereo 3D Vision for Meta Quest 3">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="stereo_styles.css">
</head>
<body>
    <div id="status">Initializing...</div>
    <div id="battery">ğŸ”‹ ---%</div>
    <video id="stereoVideo" autoplay playsinline muted preload="none" style="display: none;"></video>
    <canvas id="leftCanvas" style="display: none;"></canvas>
    <canvas id="rightCanvas" style="display: none;"></canvas>
    <img id="preview" class="hidden" alt="Stereo preview">
    
    <button id="vrButton" disabled>ğŸ¥½ Enter VR</button>
    <button id="certButton" style="position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); background: #f39c12; color: #000; border: none; padding: 12px 24px; font-size: 14px; border-radius: 8px; cursor: pointer; z-index: 1000; display: none;">ğŸ” Accept Stereo Stream Certificate</button>
    
    <!-- Debug overlay for VR (visible in headset) -->
    <div id="vrDebug" style="position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.8); color: #0f0; padding: 10px; font-family: monospace; font-size: 12px; z-index: 10000; display: none; max-width: 400px; pointer-events: none;">
        VR Debug Info
    </div>

    <!-- Robot Viewer Panel -->
    <div id="robotPanel" class="robot-panel">
        <div class="robot-panel-header" id="robotPanelHeader">
            <span class="robot-panel-title">ğŸ¤– Robot Status</span>
            <button class="robot-panel-toggle" id="robotPanelToggle">âˆ’</button>
        </div>
        <div class="robot-panel-content" id="robotPanelContent">
            <div class="robot-status-row">
                <span class="robot-status-label">Foxglove:</span>
                <span class="robot-status-value" id="foxgloveStatus">Disconnected</span>
            </div>
            <div class="robot-status-row">
                <span class="robot-status-label">TF Rate:</span>
                <span class="robot-status-value" id="tfRate">-- Hz</span>
            </div>
            <div class="robot-status-row">
                <span class="robot-status-label">URDF:</span>
                <span class="robot-status-value" id="urdfStatus">Not loaded</span>
            </div>
            <div class="robot-status-row">
                <span class="robot-status-label">Links:</span>
                <span class="robot-status-value" id="linkCount">--</span>
            </div>
            <div id="robotViewerContainer" class="robot-viewer-3d"></div>
        </div>
        <div class="robot-panel-resize-handle" id="robotPanelResize"></div>
    </div>

    <!-- Rosout Log Panel -->
    <div id="rosoutPanel" class="rosout-panel">
        <div class="rosout-panel-header" id="rosoutPanelHeader">
            <span class="rosout-panel-title">ğŸ“‹ ROS Logs</span>
            <div class="rosout-panel-controls">
                <button class="rosout-panel-clear" id="rosoutPanelClear">Clear</button>
                <button class="rosout-panel-toggle" id="rosoutPanelToggle">âˆ’</button>
            </div>
        </div>
        <div class="rosout-panel-content" id="rosoutPanelContent">
            <div id="rosoutMessages"></div>
        </div>
    </div>

    <!-- Three.js for 3D robot visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="libs/OBJLoader.js"></script>
    
    <script type="module" src="stereo_vr.js"></script>
</body>
</html>